<!DOCTYPE html>
<html>
<body>
<h2>ฝากข้อความไป Google Sheet (JSONP)</h2>
<form id="msgForm">
  <input type="text" id="message" placeholder="ฝากข้อความที่นี่" required>
  <button type="submit">ส่ง</button>
</form>
<div id="result"></div>
<script>
document.getElementById('msgForm').addEventListener('submit', function(e) {
  e.preventDefault();
  var message = document.getElementById('message').value;
  var callbackName = "cb_" + Math.random().toString(36).substr(2, 8);
  window[callbackName] = function(response) {
    document.getElementById('result').innerText = response.result === "success" ? "ส่งสำเร็จ!" : "ผิดพลาด";
    delete window[callbackName];
  };
  var script = document.createElement('script');
  script.src = "https://script.google.com/macros/s/AKfycbxeiy3nCn2VlZCUIMAVjzUPI8--AmQfHUhnS5Cq_QBGrfL5vYSy52wlqG-gD_HW4jiPEA/exec" + encodeURIComponent(message) + "&callback=" + callbackName;
  document.body.appendChild(script);
  document.getElementById('msgForm').reset();
});
</script>
</body>
</html>
